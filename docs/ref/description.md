# Description

The Wazuh Indexer is a highly scalable, full-text search and analytics engine built over [OpenSearch](https://opensearch.org/). It serves as the central data store for the Wazuh platform, indexing and storing security alerts, events, vulnerability data, and system inventory generated by Wazuh Agents and the Wazuh Server. It provides near real-time search and analytics capabilities, enabling security teams to investigate threats, monitor compliance, and gain visibility into their infrastructure.

The Wazuh Indexer can be deployed as a single-node instance for development and small environments, or as a multi-node cluster for production workloads requiring high availability and horizontal scalability.

## Core Concepts

The Wazuh Indexer stores data as JSON **documents**. Each document contains a set of fields (keys) mapped to values — strings, numbers, booleans, dates, arrays, nested objects, and more.

An **index** is a collection of related documents. For time-series data such as alerts and events, the Wazuh Indexer uses **data streams** backed by rolling indices with automatic lifecycle management.

Documents are distributed across **shards**, which are spread across cluster nodes. This distribution provides redundancy against hardware failures and allows query throughput to scale as nodes are added.

![Indexer shards](https://documentation.wazuh.com/current/_images/wazuh-indexer1.png)

## Bundled Plugins

The Wazuh Indexer ships with four purpose-built plugins that extend OpenSearch for security monitoring use cases:

### Setup Plugin

The Setup plugin initializes the indexer environment on cluster startup. It creates all required index templates, Index State Management (ISM) policies, data streams, and internal state indices. This ensures the correct schema and lifecycle rules are in place before any data is ingested. The Setup plugin defines the [Wazuh Common Schema](modules/setup/schema.md) — the standardized field mappings used across all Wazuh indices.

### Content Manager Plugin

The Content Manager plugin is responsible for keeping the Wazuh detection content up to date. It synchronizes rules, decoders, integrations, key-value databases (KVDBs), and Indicators of Compromise (IoCs) from the Wazuh Cyber Threat Intelligence (CTI) API. It also provides a REST API for managing user-generated content — custom rules, decoders, and integrations that can be drafted, tested, and promoted to the active Wazuh Engine configuration.

The Content Manager communicates with the Wazuh Engine through a Unix socket to execute log tests, validate configurations, and reload content. See [Content Manager](modules/content-manager/index.md) for details.

### Security Plugin

The Security plugin provides role-based access control (RBAC), user authentication, and TLS encryption for both the REST API and inter-node transport layers. It ships with predefined roles tailored to Wazuh operations, allowing administrators to control which users can access specific indices, APIs, and dashboards.

### Reporting Plugin

The Reporting plugin enables the generation of PDF and CSV reports from Wazuh Dashboard visualizations and saved searches. Reports can be triggered on demand or scheduled for periodic delivery.

## Data Storage

The Wazuh Indexer organizes data into purpose-specific indices:

| Index pattern | Description |
|---|---|
| `wazuh-events-*` | Raw security events from monitored endpoints |
| `wazuh-states-*` | System state and inventory data (vulnerabilities, packages, ports, etc.) |
| `wazuh-statistics-*` | Operational statistics for the Wazuh cluster |
| `.cti-*` | Content Manager system indices for CTI content |

For a complete list of indices and their schemas, see the [Setup Plugin](modules/setup/index.md) documentation.

## Integration with the Wazuh Platform

The Wazuh Indexer integrates with:

- **Wazuh Server / Engine**: Receives analyzed events and alerts; the Content Manager syncs detection content back to the Engine.
- **Wazuh Dashboard**: An OpenSearch Dashboards fork that provides the web UI for searching, visualizing, and managing Wazuh data.
- **Wazuh Agents**: Collect endpoint data that ultimately flows into the Indexer after processing by the Engine.

The Indexer exposes a standard REST API compatible with the OpenSearch API, so existing OpenSearch tools, clients, and integrations work with the Wazuh Indexer out of the box.
