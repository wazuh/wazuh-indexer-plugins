---
- name: command
  title: Wazuh commands
  short: Wazuh Inc. custom fields.
  description: >
    This index stores information about the Wazuh's commands. These commands can be sent to agents or Wazuh servers.
  type: group
  group: 2
  fields:
    - name: source
      type: keyword
      level: custom
      description: >
        Origin of the request.
      example: "wazuh"
    - name: user
      type: keyword
      level: custom
      description: >
        The user that originated the request.
      example: "user"
    - name: target.id
      type: keyword
      level: custom
      description: >
        Unique identifier of the destination to send the command to.
      example: "80a25e2d-8e52-4591-bd68-dd7e8a7baf33"
    - name: target.type
      type: keyword
      level: custom
      description: >
        The destination type. One of [`group`, `agent`, `server`]
      example: "agent"
    - name: action.name
      type: keyword
      level: custom
      description: >
        The requested action type. Examples: `restart`, `update`, `change_group`, `apply_policy`...
      example: "restart"
    - name: action.args
      type: object
      level: custom
      description: >
        Command arguments object.
      example: "\"foo\": \"bar\""
    - name: action.version
      type: keyword
      level: custom
      description: >
        Version of the command's schema.
      example: "v5.0.0"
    - name: timeout
      type: short
      level: custom
      description: >
        Seconds in which the command has to be sent to its target.
      example: 60
    - name: status
      type: keyword
      level: custom
      description: >
        Status within the Command Manager's context. One of [`pending`, `sent`, `success`, `failure`].
      example: "pending"
    - name: result.code
      type: short
      level: custom
      description: >
        Status code returned by the target.
      example: 200
    - name: result.message
      type: keyword
      level: custom
      description: >
        Result message returned by the target.
      example: "OK"
    - name: result.data
      type: keyword
      level: custom
      description: >
        Result data returned by the target.
      example: "data"
    - name: request_id
      type: keyword
      level: custom
      description: >
        UUID generated by the Command Manager.
      example: "80a25e2d-8e52-4591-bd68-dd7e8a7baf33"
    - name: order_id
      type: keyword
      level: custom
      description: >
        UUID generated by the Command Manager.
      example: "80a25e2d-8e52-4591-bd68-dd7e8a7baf33"
