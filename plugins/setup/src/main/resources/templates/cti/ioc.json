{
  "index_patterns": [
    ".cti-iocs*"
  ],
  "priority": 1,
  "template": {
    "settings": {
      "index": {
        "auto_expand_replicas": "0-1",
        "max_docvalue_fields_search": 200,
        "number_of_replicas": "0",
        "number_of_shards": "1",
        "query.default_field": [
          "document.confidence",
          "document.feed.name",
          "document.first_seen",
          "document.id",
          "document.last_seen",
          "document.name",
          "document.provider",
          "document.reference",
          "document.software.alias",
          "document.software.name",
          "document.software.type",
          "document.tags",
          "document.type",
          "type"
        ],
        "refresh_interval": "2s"
      },
      "mapping.nested_fields.limit": 50,
      "mapping.total_fields.limit": 500,
      "plugins.index_state_management.rollover_alias": ".cti-iocs"
    },
    "mappings": {
      "date_detection": false,
      "dynamic": "strict",
      "properties": {
        "document": {
          "properties": {
            "confidence": {
              "type": "long"
            },
            "feed": {
              "properties": {
                "name": {
                  "ignore_above": 1024,
                  "type": "keyword"
                }
              }
            },
            "first_seen": {
              "type": "date"
            },
            "id": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "last_seen": {
              "type": "date"
            },
            "name": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "provider": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "reference": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "software": {
              "properties": {
                "alias": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "name": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "type": {
                  "ignore_above": 1024,
                  "type": "keyword"
                }
              }
            },
            "tags": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "type": {
              "ignore_above": 1024,
              "type": "keyword"
            }
          }
        },
        "message": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "type": {
          "ignore_above": 1024,
          "type": "keyword"
        }
      }
    }
  }
}
